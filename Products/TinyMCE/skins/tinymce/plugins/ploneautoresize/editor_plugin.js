(function(){tinymce.create("tinymce.plugins.PloneAutoResizePlugin",{init:function(ed,url){var t=this,oldSize=0;if(ed.getParam("fullscreen_is_enabled"))return;function resize(){var d=ed.getDoc(),b=d.body,de=d.documentElement,DOM=tinymce.DOM,resizeHeight=t.ploneautoresize_min_height,myHeight;DOM.setStyle(DOM.get(ed.id+"_ifr"),"height","auto");myHeight=tinymce.isIE?b.scrollHeight:d.body.offsetHeight;if(myHeight>t.ploneautoresize_min_height)resizeHeight=myHeight;if(t.ploneautoresize_max_height&&myHeight>t.ploneautoresize_max_height){resizeHeight=t.ploneautoresize_max_height;ed.getBody().style.overflowY="auto"}else ed.getBody().style.overflowY="hidden";DOM.setStyle(DOM.get(ed.id+"_ifr"),"height",resizeHeight+"px");oldSize=resizeHeight;var $modal=$(ed.contentAreaContainer).parents(".modal"),$modalWrapper=$modal.parents(".modal-wrapper");modalPosition=$modalWrapper.scrollTop();if($modal.size()!==0){$modal.data("pattern-modal").positionModal();$modalWrapper.scrollTop(modalPosition)}if(t.throbbing){ed.setProgressState(false);ed.setProgressState(true)}}t.editor=ed;t.ploneautoresize_min_height=parseInt(ed.getParam("ploneautoresize_min_height",ed.getElement().offsetHeight));t.ploneautoresize_max_height=parseInt(ed.getParam("ploneautoresize_max_height",0));ed.onInit.add(function(ed){ed.dom.setStyle(ed.getBody(),"paddingBottom",ed.getParam("ploneautoresize_bottom_margin",50)+"px")});ed.onChange.add(resize);ed.onSetContent.add(resize);ed.onPaste.add(resize);ed.onKeyUp.add(resize);ed.onPostRender.add(resize);if(ed.getParam("ploneautoresize_on_init",true)){ed.onInit.add(function(ed,l){ed.setProgressState(true);t.throbbing=true;ed.getBody().style.overflowY="hidden"});ed.onLoadContent.add(function(ed,l){resize();setTimeout(function(){resize();ed.setProgressState(false);t.throbbing=false},1250)})}ed.addCommand("mcePloneAutoResize",resize)},getInfo:function(){return{longname:"Plone Auto Resize",author:"Rok Garbas",authorurl:"https://gitub.com/collective/tinymce",infourl:"https://github.com/collective/tinymce/jscripts/plugins/ploneautoresize",version:tinymce.majorVersion+"."+tinymce.minorVersion}}});tinymce.PluginManager.add("ploneautoresize",tinymce.plugins.PloneAutoResizePlugin)})();